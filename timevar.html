<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.40">

  <meta name="author" content="Prof.&nbsp;Mikael Mortensen, University of Oslo">
  <title>MATMEK-4270 presentations â€“ Time-dependent variational methods</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="styles.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Time-dependent variational methods</h1>
  <p class="subtitle">MATMEK-4270</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Mikael Mortensen, University of Oslo 
</div>
</div>
</div>

</section>
<section id="time-dependent-variational-forms" class="slide level2 smaller">
<h2>Time dependent variational forms</h2>
<p>In lectures 11-12 we have considered steady equations like</p>
<p><span class="math display">\[
\mathcal{L}(u) = f
\]</span></p>
<p>for a variety of operators <span class="math inline">\(\mathcal{L}\)</span> and a numerical solution depending only on space <span class="math inline">\(u_N(\boldsymbol{x})\)</span>.</p>
<p>In this lecture we will add consider two types of time-dependency</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial u}{\partial t} + \mathcal{L}(u) &amp;=  f \\
\frac{\partial^2 u}{\partial t^2} + \mathcal{L}(u) &amp;= f
\end{align}
\]</span></p>
<p>and approximations <span class="math inline">\(u_N(\boldsymbol{x}, t) \in V_N = \text{span}\{\psi_j\}_{j=0}^N\)</span>:</p>
<p><span class="math display">\[
u_N(\boldsymbol{x}, t) = \sum_{j=0}^N \hat{u}_j(t) \psi_j(\boldsymbol{x})
\]</span></p>
<p>where the expansion coefficients are time dependent.</p>
</section>
<section id="finite-difference-in-time-galerkin-in-space" class="slide level2 smaller">
<h2>Finite difference in time, Galerkin in space</h2>
<p>Consider the equation</p>
<p><span class="math display">\[
\frac{\partial u}{\partial t} + \mathcal{L}(u) = f
\]</span></p>
<p>A finite difference approximation in time, with forward Euler:</p>
<p><span class="math display">\[
\frac{u^{n+1}-u^n}{\Delta t} + \mathcal{L}(u^n) = f^n
\]</span></p>
<p>where</p>
<p><span class="math display">\[
u^n(\boldsymbol{x}) = u(\boldsymbol{x}, t_n), f^n(\boldsymbol{x}) = f(\boldsymbol{x}, t_n)
\]</span></p>
<p>and time is discretized as always for time domain <span class="math inline">\([0, T]\)</span></p>
<p><span class="math display">\[
t_n = n \Delta t, \quad n=0,1, \ldots, N_t, \quad N_t=T/\Delta t
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>We normally drop the spatial dependence and write only <span class="math inline">\(u^n\)</span> or <span class="math inline">\(f^n\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="the-residual-is-now-a-function-of-time" class="slide level2 smaller">
<h2>The residual is now a function of time</h2>
<p><span class="math display">\[
\mathcal{R}(u^{n+1}; u^n) = \frac{u^{n+1}-u^n}{\Delta t} + \mathcal{L}(u^n) - f^n
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The notation <span class="math inline">\(\mathcal{R}(u^{n+1}; u^n)\)</span> is used to indicate that <span class="math inline">\(u^{n+1}\)</span> is the unknown and <span class="math inline">\(u^n\)</span> (right of the semicolon) is known.</p>
</div>
</div>
</div>
<p>Introduce the approximation to <span class="math inline">\(u^n(\boldsymbol{x})=u(\boldsymbol{x}, t_n)\)</span></p>
<p><span class="math display">\[
u(\boldsymbol{x}, t_n) \approx u^{n}_N(\boldsymbol{x}) = \sum_{j=0}^N \hat{u}^{n}_j \psi_j(\boldsymbol{x})
\]</span></p>
<p>where <span class="math inline">\(\hat{u}^n_j = \hat{u}_j(t_n)\)</span> are the time dependent expansion coefficients (the unknowns at time <span class="math inline">\(t_n\)</span>). Insert into the residual to get the <strong>numerical residual</strong></p>
<p><span class="math display">\[
\mathcal{R}_N = \mathcal{R}(u^{n+1}_N; u^{n}_N) = \frac{u_N^{n+1}-u_N^n}{\Delta t} + \mathcal{L}(u_N^n) - f^n
\]</span></p>
</section>
<section id="the-method-of-weighted-residuals" class="slide level2 smaller">
<h2>The method of weighted residuals</h2>
<p>The method of weighted residuals is to find <span class="math inline">\(u^{n+1}_N \in V_N\)</span> such that</p>
<p><span class="math display">\[
(\mathcal{R}_N, v) = 0, \quad \forall \, v \in W
\]</span></p>
<p>and for the Galerkin method <span class="math inline">\(W = V_N\)</span>.</p>
<div class="fragment">
<p>In order to solve the time-dependent problem we need to solve this Galerkin problem many times. The procedure is</p>
<ol type="1">
<li>Initialize <span class="math inline">\(u_N^0(\boldsymbol{x})\)</span> by projecting the given initial condition <span class="math inline">\(u(\boldsymbol{x}, 0)\)</span> to <span class="math inline">\(V_N\)</span> (function approximation, see lectures 8, 9). That is, find <span class="math inline">\(u^0_N \in V_N\)</span> such that <span class="math display">\[
(u^0_N-u(\boldsymbol{x}, 0), v)=0, \quad \forall \, v \in V_N
\]</span></li>
<li>For <span class="math inline">\(n = 0, 1, \ldots, N_t-1\)</span> find <span class="math inline">\(u^{n+1}_N \in V_N\)</span> such that</li>
</ol>
<p><span class="math display">\[
(\mathcal{R}_N, v) = 0, \quad \forall \, v \in V_N
\]</span></p>
</div>
</section>
<section>
<section id="stability-of-time-dependent-variational-methods" class="title-slide slide level1 center">
<h1>Stability of time-dependent variational methods</h1>

</section>
<section id="recap" class="slide level2 smaller">
<h2>Recap</h2>
<p>Remember the early lectures 2, 3 and 5</p>
<p><span class="math display">\[
\text{Exponential decay}\quad\frac{\partial u(t)}{\partial t} = -a u(t)
\]</span></p>
<p><span class="math display">\[
\text{Vibration equation} \quad \frac{\partial^2 u(t)}{\partial t^2} + \omega^2 u(t) = 0
\]</span></p>
<p><span class="math display">\[
\text{Wave equation} \quad \frac{\partial^2 u(x, t)}{\partial t^2} = c^2\frac{\partial^2 u(x, t)}{\partial x^2}
\]</span></p>
<p>In order to study stability we introduced the ansatz</p>
<p><span class="math display">\[
u^{n+1} = g u^{n} \rightarrow u^{n} = g^n u^0
\]</span></p>
<p>into the discretized equations. For stability we required <span class="math inline">\(|g| \le 1\)</span>.</p>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>We actually called the amplification factor <span class="math inline">\(A\)</span>, but since then we have started using matrices that we rather have as <span class="math inline">\(A\)</span>. Hence the amplification factor is now called <span class="math inline">\(g\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="recap-vibration-equation" class="slide level2 smaller">
<h2>Recap vibration equation</h2>
<p><span class="math display">\[
\frac{\partial^2 u(t)}{\partial t^2} + \omega^2 u(t) = 0
\]</span></p>
<p>Discretize with central finite difference</p>
<p><span class="math display">\[
\frac{u^{n+1}-2u^n+u^{n-1}}{\Delta t^2} + \omega^2 u^n = 0
\]</span></p>
<p>Insert for ansatz <span class="math inline">\(u^n = g^n u^0\)</span></p>
<p><span class="math display">\[
g^n(g-2+g^{-1})u^{0} + (\omega \Delta t)^2 g^n u^0 = 0
\]</span></p>
<p>Divide by <span class="math inline">\(g^n u^0\)</span> <span class="math display">\[
g+g^{-1} = 2-(\omega \Delta t)^2
\]</span></p>
<p>and solve quadratic equation (<span class="math inline">\(g\)</span> may be complex) to find stability <span class="math inline">\(|g|=1\)</span> for <span class="math display">\[
\omega \Delta t \le 2
\]</span></p>
</section>
<section id="recap---stability-of-the-diffusion-equation" class="slide level2 smaller">
<h2>Recap - stability of the diffusion equation</h2>
<p><span class="math display">\[
\frac{\partial u(x, t)}{\partial t} = \frac{\partial^2 u(x, t)}{\partial x^2}
\]</span></p>
<p>Use forward Euler int time and central difference in space</p>
<p><span class="math display">\[
u_j^{n+1} - u_j^n = \frac{\Delta t}{\Delta x^2} (u^n_{j+1}-2u^n_j+u^n_{j-1})
\]</span></p>
<p>where <span class="math inline">\(u^n_j = u(j\Delta x, n\Delta t)\)</span> and <span class="math inline">\(x_j=j\Delta x\)</span> and <span class="math inline">\(t_n=n\Delta t\)</span>. Make the ansatz as always</p>
<p><span class="math display">\[
u^{n+1}_j = g u^{n}_j \rightarrow u^{n}_j = g^n u^0_j
\]</span></p>
<p>and let the initial condition be a periodic Fourier wave with wavenumber <span class="math inline">\(k\)</span></p>
<p><span class="math display">\[
u^0_j = e^{\hat{\imath}k x_j}
\]</span></p>
<p>where <span class="math inline">\(\hat{\imath}=\sqrt{-1}\)</span>.</p>
</section>
<section id="write-the-equation-in-matrix-form" class="slide level2 smaller">
<h2>Write the equation in matrix form</h2>
<p><span class="math display">\[
u_j^{n+1} - u_j^n = \frac{\Delta t}{\Delta x^2} (u^n_{j+1}-2u^n_j+u^n_{j-1})
\]</span></p>
<p><span class="math display">\[
\boldsymbol{u}^n = (u^n_j)_{j=0}^N
\]</span></p>
<p><span class="math display">\[
\boldsymbol{u}^{n+1}-\boldsymbol{u}^n = \frac{\Delta t}{\Delta x^2}\tilde{D}^{(2)} \boldsymbol{u}^n
\]</span></p>
<p><span class="math display">\[
D^{(2)} = \frac{1}{\Delta x^2} \tilde{D}^{(2)} = \frac{1}{\Delta x^2} \underbrace{\begin{bmatrix}
-2 &amp; 1 &amp; 0 &amp; 0  &amp; 0 &amp; 0 &amp; 0 &amp; 1  \\
1 &amp; -2 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; -2 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\vdots &amp; &amp; &amp; \ddots &amp;  &amp; &amp; &amp;\cdots \\
0 &amp; 0 &amp; 0 &amp; 0 &amp;  1&amp; -2&amp; 1&amp; 0 \\
0 &amp; 0 &amp; 0&amp; 0&amp; 0&amp; 1&amp; -2&amp; 1 \\
1 &amp; 0 &amp; 0 &amp; 0  &amp; 0 &amp; 0 &amp; 1 &amp; -2 \\
\end{bmatrix}}_{\tilde{D}^{(2)}}
\]</span></p>
</section>
<section id="find-the-amplification-factor" class="slide level2 smaller">
<h2>Find the amplification factor</h2>
<p><span class="math display">\[
\boldsymbol{u}^{n+1}-\boldsymbol{u}^n = \frac{\Delta t}{\Delta x^2}\tilde{D}^{(2)} \boldsymbol{u}^n
\]</span></p>
<p>Insert for ansatz <span class="math inline">\(\boldsymbol{u}^n = g^n \boldsymbol{u}^0\)</span></p>
<p><span class="math display">\[
(g-1)\boldsymbol{u}^0 = \frac{\Delta t}{\Delta x^2} \tilde{D}^{(2)} \boldsymbol{u}^0
\]</span></p>
<p>Inserting for <span class="math inline">\({u}_j^0=e^{ik j \Delta x}\)</span> we get</p>
<p><span class="math display">\[
(g-1)e^{ikj \Delta x} = \frac{\Delta t}{\Delta x^2} (e^{ik(j+1)\Delta x} - 2e^{ikj\Delta x} + e^{ik(j-1)\Delta x})
\]</span></p>
<p>Divide by <span class="math inline">\(e^{ikj\Delta x}\)</span> to obtain</p>
<p><span class="math display">\[
g-1 = \frac{\Delta t}{\Delta x^2} (e^{ik\Delta x} - 2 + e^{-ik\Delta x})
\]</span></p>
</section>
<section id="simplify-small-g-1-fracdelta-tdelta-x2-eikdelta-x---2-e-ikdelta-x" class="slide level2 smaller">
<h2>Simplify <span class="math inline">\(\small g-1 = \frac{\Delta t}{\Delta x^2} (e^{ik\Delta x} - 2 + e^{-ik\Delta x})\)</span></h2>
<p>Use <span class="math inline">\(e^{ix}+e^{-ix} = 2 \cos x\)</span>, <span class="math inline">\(\cos(2x) = \cos^2 x - \sin^2 x\)</span> and <span class="math inline">\(1=\cos^2x+\sin^2x\)</span></p>
<p><span class="math display">\[
g = 1 - \frac{4 \Delta t}{\Delta x^2}\sin^2\left(\frac{k\Delta x}{2}\right)
\]</span></p>
<div class="fragment">
<p>We want <span class="math inline">\(|g|\le 1\)</span>, so we need</p>
<p><span class="math display">\[
\Big|1 - \frac{4 \Delta t}{\Delta x^2}\sin^2\left(\frac{k\Delta x}{2}\right)\Big| \le 1
\]</span></p>
</div>
<div class="fragment">
<p>Since <span class="math inline">\(\sin^2\left(k \Delta x/2\right) \le 1\)</span> and positive, we get that <span class="math inline">\(1- \frac{4 \Delta t}{\Delta x^2}\)</span> is always less than 1. However, <span class="math inline">\(1- \frac{4 \Delta t}{\Delta x^2}\)</span> can be smaller than <span class="math inline">\(-1\)</span>, and that gives us the stability limit</p>
<p><span class="math display">\[
1- \frac{4 \Delta t}{\Delta x^2} \ge -1 \Rightarrow \boxed{\Delta t \le \frac{\Delta x^2}{2}}
\]</span></p>
</div>
</section>
<section id="a-lot-of-hard-work-to-find" class="slide level2 smaller">
<h2>A lot of hard work to find</h2>
<p><span class="math display">\[
\left|1- \frac{4 \Delta t}{\Delta x^2} \right| \le 1 \Rightarrow \Delta t \le \frac{\Delta x^2}{2}
\]</span></p>
<p>Can we find an easier approach?</p>
<div class="fragment">
<p>We have the simple looking formula</p>
<p><span class="math display">\[
(g-1)\boldsymbol{u}^0 = \frac{\Delta t}{\Delta x^2} \tilde{D}^{(2)} \boldsymbol{u}^0
\]</span></p>
<p>But we cannot eliminate the two <span class="math inline">\(\boldsymbol{u}^0\)</span> terms on each side because of the matrix <span class="math inline">\(\tilde{D}^{(2)}\)</span>!</p>
</div>
<div class="fragment">
<p>Eigenvalues! The eigenvalues <span class="math inline">\(\lambda\)</span> of a matrix <span class="math inline">\(A\)</span> with associated eigenvectors <span class="math inline">\(\boldsymbol{x}\)</span> are</p>
<p><span class="math display">\[
A  \boldsymbol{x} = \lambda \boldsymbol{x}
\]</span></p>
<p>Hence the simplification</p>
<p><span class="math display">\[
\tilde{D}^{(2)} \boldsymbol{u}^0 = \lambda \boldsymbol{u}^0 \Rightarrow (g-1)\boldsymbol{u}^0 = \frac{\Delta t}{\Delta x^2} \lambda \boldsymbol{u}^0 \Rightarrow g=1+\frac{\lambda \Delta t}{\Delta x^2}
\]</span></p>
</div>
</section>
<section id="stability-limit-through-eigenvalues" class="slide level2 smaller">
<h2>Stability limit through eigenvalues</h2>
<p>Assume the ansatz <span class="math inline">\(\boldsymbol{u}^n=g^n\boldsymbol{u}^0\)</span>: <span class="math display">\[
(g-1)\boldsymbol{u}^0 = \frac{\Delta t}{\Delta x^2} \tilde{D}^{(2)} \boldsymbol{u}^0
\]</span></p>
<p>Insert for <span class="math inline">\(\tilde{D}^{(2)}\boldsymbol{u}^0 = \lambda \boldsymbol{u}^0\)</span> to get</p>
<p><span class="math display">\[
g=1+\frac{\lambda \Delta t}{ \Delta x^2}
\]</span></p>
<p>To satisfy <span class="math inline">\(|g| \le 1\)</span></p>
<p><span class="math display">\[
|g|=|1+\frac{\lambda \Delta t}{ \Delta x^2}| \le 1
\]</span></p>
<p>But we need to compute the eigenvalues..</p>
</section>
<section id="compute-eigenvalues" class="slide level2 smaller">
<h2>Compute eigenvalues</h2>
<div id="adbc8630" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a></a><span class="im">from</span> scipy <span class="im">import</span> sparse</span>
<span id="cb1-3"><a></a>N <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb1-4"><a></a>D2 <span class="op">=</span> sparse.diags((<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), (<span class="op">-</span>N, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, N), shape<span class="op">=</span>(N<span class="op">+</span><span class="dv">1</span>, N<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb1-5"><a></a>Lambda <span class="op">=</span> np.linalg.eig(D2.toarray())[<span class="dv">0</span>]</span>
<span id="cb1-6"><a></a>Lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>array([-4.00000000e+00, -3.73205081e+00, -3.00000000e+00, -2.00000000e+00,
       -1.00000000e+00, -4.53075522e-16, -2.67949192e-01, -2.67949192e-01,
       -1.00000000e+00, -3.73205081e+00, -2.00000000e+00, -3.00000000e+00])</code></pre>
</div>
</div>
<p>The minimum eigenvalue is -4 (worst case). Hence we obtain again exactly the same limit</p>
<p><span class="math display">\[
|1+\frac{\lambda \Delta t}{ \Delta x^2}|\le 1 \Rightarrow |1-\frac{4 \Delta t}{ \Delta x^2}| \le 1 \Rightarrow \Delta t \le \frac{\Delta x^2}{2}
\]</span></p>
<p>But with a lot less work!</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The complex exponentials <span class="math inline">\(e^{\hat{\imath} k x}\)</span> are eigenfunctions of the Laplace operator in 1D, so we actually used eigenvalue theory also for the hard approach, we just did not mention it!</p>
</div>
</div>
</div>
</section>
<section id="stability-of-the-forward-euler-method-for-variational-forms" class="slide level2 smaller">
<h2>Stability of the forward Euler method for variational forms</h2>
<p>For the forward Euler method we now consider the discretized Galerkin equation</p>
<p><span class="math display">\[
\left(u^{n+1}_N, v\right) = \left(u^{n}_N, v\right) + \Delta t \left(\mathcal{L}(u^n_N), v\right)
\]</span></p>
<p>and make the same ansatz as before</p>
<p><span class="math display">\[
u_N^{n+1} = g u_N^n \quad \text{and thus} \quad u^{n}_N = g^n u^0_N
\]</span></p>
<div class="fragment">
<p>Insert into the variational form</p>
<p><span class="math display">\[
\left(g^{n+1}u^{0}_N, v\right) = \left(g^n u^{0}_N, v\right) + \Delta t \left(\mathcal{L}(g^n u^0_N), v\right)
\]</span></p>
<p>Divide by <span class="math inline">\(g^n\)</span> (<span class="math inline">\(g\)</span> is not dependent on <span class="math inline">\(x\)</span>) to obtain</p>
<p><span class="math display">\[
g \left(u^{0}_N, v\right) = \left(u^{0}_N, v\right) + \Delta t \left(\mathcal{L}(u^0_N), v\right)
\]</span></p>
</div>
</section>
<section id="derive-the-linear-algebra-form" class="slide level2 smaller">
<h2>Derive the linear algebra form</h2>
<p>Insert for <span class="math inline">\(u^0_N = \sum_{j=0}^N \hat{u}^0_j \psi_j\)</span> and <span class="math inline">\(v=\psi_i\)</span> to obtain</p>
<p><span class="math display">\[
g \sum_{j=0}^N \left(\psi_j, \psi_i \right) \hat{u}^0_j = \sum_{j=0}^N \left(\psi_j, \psi_i\right)\hat{u}^0_j + \Delta t \sum_{j=0}^N\left(\mathcal{L}(\psi_j), \psi_i\right) \hat{u}^0_j
\]</span></p>
<p>In matrix form this is</p>
<p><span class="math display">\[
g A \boldsymbol{\hat{u}}^0 = A \boldsymbol{\hat{u}}^0 + \Delta t M \boldsymbol{\hat{u}}^0
\]</span></p>
<p>where <span class="math inline">\(a_{ij}=(\psi_j, \psi_i)\)</span> and <span class="math inline">\(m_{ij} = \left( \mathcal{L}(\psi_j), \psi_i\right)\)</span>. Multiply from the left by <span class="math inline">\(A^{-1}\)</span> to obtain</p>
<p><span class="math display">\[
g \boldsymbol{\hat{u}}^0 = \boldsymbol{\hat{u}}^0 + \Delta t A^{-1}M \boldsymbol{\hat{u}}^0
\]</span></p>
<div class="fragment">
<p>Compute the eigenvalues <span class="math inline">\(\lambda\)</span> of the matrix <span class="math inline">\(H = A^{-1}M\)</span> such that <span class="math inline">\(H \boldsymbol{\hat{u}}^0 = \lambda \boldsymbol{\hat{u}}^0\)</span> and</p>
<p><span class="math display">\[
g \boldsymbol{\hat{u}}^0 = \boldsymbol{\hat{u}}^0 + \lambda \Delta t \boldsymbol{\hat{u}}^0 \Rightarrow \boxed{g = 1 + \lambda \Delta t}
\]</span></p>
<p><span class="math display">\[
\text{Stability limit:}\quad |g| = |1+\lambda \Delta t| \le 1
\]</span></p>
</div>
</section>
<section id="complete-worked-example-the-diffusion-equation" class="slide level2 smaller">
<h2>Complete worked example, the diffusion equation</h2>
<p><span class="math display">\[
\frac{\partial u}{\partial t} = \frac{\partial^2 u}{\partial x^2}, \quad x, t \in (0, L) \times (0, T]
\]</span></p>
<p><span class="math display">\[
\begin{align}
u(x, 0) &amp;= p(x)=\sin(\pi x /L) + \sin(10 \pi x/L) \\
u(0, t) &amp;= 0, u(L, t) = 0
\end{align}
\]</span></p>
<p>Forward Euler in time, Galerkin in space, and Dirichlet Legendre polynomials:</p>
<p><span class="math display">\[
\begin{matrix}
\text{Basis:}\,\, &amp; \psi_j(x) = P_j(X)-P_{j+2}(X) &amp; V_N = \text{span}\{\psi_j\}_{j=0}^N \\
\text{Mapping:} &amp; x(X) = \frac{L}{2}(1+X) &amp; X(x) = \frac{2x}{L}-1
\end{matrix}
\]</span></p>
<div class="fragment">
<p>We get the variational form used on the previous slide with diffusion for <span class="math inline">\(\mathcal{L}(\psi_j)\)</span> and integration by parts (boundary terms canceled since <span class="math inline">\(\psi_j(0)=\psi_j(L)=0\)</span>): <span class="math display">\[
\sum_{j=0}^N(\psi_j, \psi_i) \hat{u}^{n+1}_j = \sum_{j=0}^N(\psi_j, \psi_i) \hat{u}^{n}_j - \Delta t\left( \sum_{j=0}^N (\psi'_j, \psi'_i) \hat{u}^{n}_j - \cancel{[u^n_N \psi_i]_{x=0}^{x=L}} \right)
\]</span></p>
</div>
</section>
<section id="the-stiffness-matrix-psi_j-psi_i" class="slide level2 smaller">
<h2>The stiffness matrix <span class="math inline">\((\psi'_j, \psi'_i)\)</span></h2>
<p><span class="math display">\[
\begin{align}
\int_{0}^L\psi'_j(x) \psi'_i(x) dx &amp;= \int_{-1}^1 (P'_{j}(X)-P'_{j+2}(X))\frac{dX}{dx} (P'_{i}(X)-P'_{i+2}(X))\frac{dX}{dx} \frac{dx}{dX}dX \\
&amp;= \frac{2}{L} \int_{-1}^1 (P'_{j}(X)-P'_{j+2}(X)) (P'_{i}(X)-P'_{i+2}(X))dX \\
&amp;= \frac{2}{L}(P'_{j}-P'_{j+2}, P'_{i}-P'_{i+2})_{L^2(-1, 1)}
\end{align}
\]</span></p>
<div class="fragment">
<p>Using equality: <span class="math inline">\((2j+3)P_{j+1} = P'_{j+2}-P'_{j}\)</span> and <span class="math inline">\((P_{i+1}, P_{j+1})_{L^2(-1,1)}=\|P_{i+1}\|^2\delta_{ij}\)</span> and <span class="math inline">\(\|P_i\|^2=\frac{2}{2j+1}\)</span></p>
<p><span class="math display">\[
\begin{align}
\int_{0}^L\psi'_j(x) \psi'_i(x) dx &amp;= \frac{2}{L}(-(2j+3)P_{j+1}, -(2j+3)P_{i+1}) \\
&amp;= \frac{2}{L}(2j+3)^2\|P_{i+1}\|^2 \delta_{ij}\\
&amp;= \frac{8j+12}{L} \delta_{ij}
\end{align}
\]</span></p>
</div>
</section>
<section id="the-mass-matrix-psi_j-psi_i" class="slide level2 smaller">
<h2>The mass matrix <span class="math inline">\((\psi_j, \psi_i)\)</span></h2>
<p><span class="math display">\[
\begin{align}
\int_{0}^L\psi_j(x) \psi_i(x) dx &amp;= \int_{-1}^1 (P_{j}(X)-P_{j+2}(X)) (P_{i}(X)-P_{i+2}(X))\frac{dx}{dX}dX \\
&amp;= \frac{L}{2}(P_{j}-P_{j+2}, P_i-P_{i+2})_{L^2(-1, 1)} \\
&amp;= \frac{L}{2}\left( (P_j, P_i) - (P_{j+2}, P_i) - (P_j, P_{i+2}) + (P_{j+2}, P_{i+2}) \right)
\end{align}
\]</span></p>
<div class="fragment">
<p>Using now <span class="math inline">\((P_j, P_i) = \|P_i\|^2 \delta_{ij} = \frac{2}{2i+1} \delta_{ij}\)</span>:</p>
<p><span class="math display">\[
\begin{matrix}
j=i &amp; (\psi_i, \psi_i) = \frac{L}{2}((P_i, P_i) + (P_{i+2}, P_{i+2})) = \frac{L}{2}(\|P_i\|^2 + \|P_{i+2}\|^2) \\
j=i+2 &amp; (\psi_{i+2}, \psi_i) = -(P_{i+2}, P_{i+2}) = - \frac{L}{2}\|P_{i+2}\|^2
\end{matrix}
\]</span></p>
<p>Since the mass matrix <span class="math inline">\(a_{ij}=a_{ji}=(\psi_j, \psi_i)\)</span> is symmetric, we get the tri-diagonal</p>
<p><span class="math display">\[
a_{ij} = a_{ji} = \frac{L}{2}\begin{cases} \|P_i\|^2+\|P_{i+2}\|^2, \quad &amp;i = j \\
- \|P_{i+2}\|^2, \quad  &amp;j = i+2 \\
0, \quad &amp;\text{otherwise}
\end{cases}
\]</span></p>
</div>
</section>
<section id="implementation" class="slide level2 smaller">
<h2>Implementation</h2>
<p>It is rather messy to work with composite basis functions. A very smart trick is thus to use a <strong>stencil matrix</strong> <span class="math inline">\(S\)</span>, such that (summation on repeated <span class="math inline">\(j\)</span> index)</p>
<p><span class="math display">\[
\psi_i = P_i-P_{i+2} = s_{ij} P_j
\]</span></p>
<p>This defines <span class="math inline">\(S \in \mathbb{R}^{(N+1) \times (N+3)}\)</span> for the Dirichlet problem as</p>
<p><span class="math display">\[
s_{ij} = \begin{cases} 1 \quad &amp;i=j \\
-1 \quad &amp;j=i+2
\end{cases}
\quad S = \begin{bmatrix}
1 &amp; 0 &amp; -1 &amp; 0 &amp; 0 &amp; \cdots\\
0 &amp; 1 &amp; 0 &amp; -1 &amp; 0 &amp; \cdots\\
0 &amp; 0 &amp; 1 &amp; 0 &amp; -1 &amp; \cdots\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; \ddots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 &amp; 0 &amp; -1
\end{bmatrix}
\]</span></p>
<p>With <span class="math inline">\(\boldsymbol{\psi} = \{\psi_i\}_{i=0}^N\)</span> and <span class="math inline">\(\boldsymbol{P}=\{P_i\}_{i=0}^{N+2}\)</span> we get all basis functions in matrix form:</p>
<p><span class="math display">\[
\boldsymbol{\psi} = S \boldsymbol{P}
\]</span></p>
</section>
<section id="why-is-the-stencil-matrix-smart" class="slide level2 smaller">
<h2>Why is the stencil matrix smart?</h2>
<p>Consider the mass matrix</p>
<p><span class="math display">\[
\begin{align}
(\psi_j, \psi_i) &amp;= (P_j-P_{j+2}, P_i-P_{i+2}) \\
&amp;= (P_j, P_i) - (P_j, P_{i+2}) - (P_{j+2}, P_i) + (P_{j+2}, P_{i+2})
\end{align}
\]</span></p>
<p>You need to sort out the four (diagonal) matrices on the right.</p>
<div class="fragment">
<p>Now use stencil matrix instead (summation on <span class="math inline">\(k\)</span> and <span class="math inline">\(l\)</span>):</p>
<p><span class="math display">\[
\begin{align}
(\psi_j, \psi_i) &amp;= (s_{jk}P_k, s_{il}P_l) \\
&amp;= s_{il} (P_l, P_k) s_{jk}
\end{align}
\]</span></p>
<p>You need only the diagonal matrix <span class="math inline">\(P = ((P_l, P_k))_{k,l=0}^{N+2}\)</span>, where <span class="math inline">\((P_l, P_k)=\frac{2}{2l+1}\delta_{kl}\)</span>.</p>
<p>Matrix form</p>
<p><span class="math display">\[
A = ((\psi_j, \psi_i))_{i,j=0}^{N} = S P S^T
\]</span></p>
</div>
</section>
<section id="stiffness-matrix-through-stencil-matrix" class="slide level2 smaller">
<h2>Stiffness matrix through stencil matrix</h2>
<p><span class="math display">\[
\begin{align}
(\psi''_j, \psi_i) &amp;= (s_{jk}P''_k, s_{il}P_l) \\
&amp;= s_{il} (P''_l, P_k) s_{jk}
\end{align}
\]</span></p>
<p>Again you need only the single matrix using orthogonal polynomials <span class="math inline">\(q_{kl}=(P''_l, P_k) = -(P'_l, P'_k)\)</span></p>
<p><span class="math display">\[
M = ((\psi''_j, \psi_i))_{i,j=0}^{N} = S Q S^T
\]</span></p>
</section>
<section id="implementation-using-shenfun" class="slide level2 smaller">
<h2>Implementation using shenfun</h2>
<div id="05201018" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb3-3"><a></a><span class="im">from</span> scipy <span class="im">import</span> sparse</span>
<span id="cb3-4"><a></a><span class="im">from</span> shenfun <span class="im">import</span> TrialFunction, TestFunction, FunctionSpace, <span class="op">\</span></span>
<span id="cb3-5"><a></a>    project, inner, Dx, la, Function</span>
<span id="cb3-6"><a></a></span>
<span id="cb3-7"><a></a>x, t, c, L <span class="op">=</span> sp.symbols(<span class="st">'x,t,c,L'</span>)</span>
<span id="cb3-8"><a></a></span>
<span id="cb3-9"><a></a><span class="kw">class</span> FE_Diffusion:</span>
<span id="cb3-10"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, N, L0<span class="op">=</span><span class="dv">1</span>, u0<span class="op">=</span>sp.sin(sp.pi<span class="op">*</span>x<span class="op">/</span>L)<span class="op">+</span>sp.sin(<span class="dv">10</span><span class="op">*</span>sp.pi<span class="op">*</span>x<span class="op">/</span>L), family<span class="op">=</span><span class="st">'L'</span>):</span>
<span id="cb3-11"><a></a>        <span class="va">self</span>.N <span class="op">=</span> N</span>
<span id="cb3-12"><a></a>        <span class="va">self</span>.L <span class="op">=</span> L0</span>
<span id="cb3-13"><a></a>        <span class="va">self</span>.u0 <span class="op">=</span> u0.subs({L: L0})</span>
<span id="cb3-14"><a></a>        <span class="va">self</span>.V <span class="op">=</span> <span class="va">self</span>.get_function_space(family<span class="op">=</span>family)</span>
<span id="cb3-15"><a></a>        <span class="va">self</span>.uh_np1 <span class="op">=</span> Function(<span class="va">self</span>.V)</span>
<span id="cb3-16"><a></a>        <span class="va">self</span>.uh_n <span class="op">=</span> Function(<span class="va">self</span>.V)</span>
<span id="cb3-17"><a></a>        <span class="va">self</span>.A, <span class="va">self</span>.S <span class="op">=</span> <span class="va">self</span>.get_mats()</span>
<span id="cb3-18"><a></a>        <span class="va">self</span>.sol <span class="op">=</span> la.Solver(<span class="va">self</span>.A)</span>
<span id="cb3-19"><a></a>        <span class="va">self</span>.A <span class="op">=</span> <span class="va">self</span>.A.diags()</span>
<span id="cb3-20"><a></a>        <span class="va">self</span>.S <span class="op">=</span> <span class="va">self</span>.S.diags()</span>
<span id="cb3-21"><a></a>        </span>
<span id="cb3-22"><a></a>    <span class="kw">def</span> get_function_space(<span class="va">self</span>, family<span class="op">=</span><span class="st">'L'</span>):</span>
<span id="cb3-23"><a></a>        <span class="cf">return</span> FunctionSpace(<span class="va">self</span>.N<span class="op">+</span><span class="dv">1</span>, family, bc<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">0</span>), domain<span class="op">=</span>(<span class="dv">0</span>, <span class="va">self</span>.L))</span>
<span id="cb3-24"><a></a></span>
<span id="cb3-25"><a></a>    <span class="kw">def</span> get_mats(<span class="va">self</span>):</span>
<span id="cb3-26"><a></a>        N <span class="op">=</span> <span class="va">self</span>.N</span>
<span id="cb3-27"><a></a>        u <span class="op">=</span> TrialFunction(<span class="va">self</span>.V)</span>
<span id="cb3-28"><a></a>        v <span class="op">=</span> TestFunction(<span class="va">self</span>.V)</span>
<span id="cb3-29"><a></a>        a <span class="op">=</span> inner(u, v)</span>
<span id="cb3-30"><a></a>        s <span class="op">=</span> inner(Dx(u, <span class="dv">0</span>, <span class="dv">1</span>), Dx(v, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb3-31"><a></a>        <span class="cf">return</span> a, s</span>
<span id="cb3-32"><a></a></span>
<span id="cb3-33"><a></a>    <span class="kw">def</span> get_eigenvalues(<span class="va">self</span>):</span>
<span id="cb3-34"><a></a>        <span class="cf">return</span> np.linalg.eig(np.linalg.inv(<span class="va">self</span>.A.toarray()) <span class="op">@</span> <span class="va">self</span>.S.toarray())[<span class="dv">0</span>]</span>
<span id="cb3-35"><a></a></span>
<span id="cb3-36"><a></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, Nt, dt<span class="op">=</span><span class="fl">0.1</span>, save_step<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb3-37"><a></a>        <span class="va">self</span>.uh_n[:] <span class="op">=</span> project(<span class="va">self</span>.u0, <span class="va">self</span>.V) <span class="co"># unm1 = u(x, 0)</span></span>
<span id="cb3-38"><a></a>        xj <span class="op">=</span> <span class="va">self</span>.V.mesh()</span>
<span id="cb3-39"><a></a>        plotdata <span class="op">=</span> {<span class="dv">0</span>: <span class="va">self</span>.uh_n(xj)}</span>
<span id="cb3-40"><a></a>        f <span class="op">=</span> Function(<span class="va">self</span>.V)</span>
<span id="cb3-41"><a></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, Nt<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb3-42"><a></a>            f[:<span class="op">-</span><span class="dv">2</span>] <span class="op">=</span> <span class="va">self</span>.A <span class="op">@</span> <span class="va">self</span>.uh_n[:<span class="op">-</span><span class="dv">2</span>] <span class="op">-</span> dt<span class="op">*</span>(<span class="va">self</span>.S <span class="op">@</span> <span class="va">self</span>.uh_n[:<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb3-43"><a></a>            <span class="va">self</span>.uh_np1[:] <span class="op">=</span> <span class="va">self</span>.sol(f)</span>
<span id="cb3-44"><a></a>            <span class="va">self</span>.uh_n[:] <span class="op">=</span> <span class="va">self</span>.uh_np1</span>
<span id="cb3-45"><a></a>            <span class="cf">if</span> n <span class="op">%</span> save_step <span class="op">==</span> <span class="dv">0</span>: <span class="co"># save every save_step timestep</span></span>
<span id="cb3-46"><a></a>                plotdata[n] <span class="op">=</span> <span class="va">self</span>.uh_np1(xj)</span>
<span id="cb3-47"><a></a>        <span class="cf">return</span> plotdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run-solver" class="slide level2 smaller">
<h2>Run solver</h2>
<div class="columns">
<div class="column">
<p>Use longest stable time step <span class="math inline">\(dt=2/\max (\lambda)\)</span></p>
<div id="07a16d2d" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="im">from</span> utilities <span class="im">import</span> plot_with_offset</span>
<span id="cb4-2"><a></a>sol <span class="op">=</span> FE_Diffusion(<span class="dv">42</span>, L0<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-3"><a></a>dt <span class="op">=</span> <span class="dv">2</span><span class="op">/</span><span class="bu">max</span>(sol.get_eigenvalues())</span>
<span id="cb4-4"><a></a>data <span class="op">=</span> sol(<span class="dv">1000</span>, dt<span class="op">=</span>dt, save_step<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb4-5"><a></a>plot_with_offset(data, sol.V.mesh(), figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="timevar_files/figure-revealjs/cell-4-output-1.png" width="641" height="263"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<p>Use slightly too large time step <span class="math inline">\(dt=2.04/\max (\lambda)\)</span></p>
<div id="5ff42f3c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="co">#</span></span>
<span id="cb5-2"><a></a><span class="co">#</span></span>
<span id="cb5-3"><a></a><span class="co">#</span></span>
<span id="cb5-4"><a></a>data <span class="op">=</span> sol(<span class="dv">1000</span>, dt<span class="op">=</span>dt<span class="op">*</span><span class="fl">1.02</span>, save_step<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb5-5"><a></a>plot_with_offset(data, sol.V.mesh(), figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="timevar_files/figure-revealjs/cell-5-output-1.png" width="658" height="263"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="backward-euler-for-diffusion-equation" class="slide level2 smaller">
<h2>Backward Euler for diffusion equation</h2>
<p>The forward Euler method requires a very short time step for the diffusion equation. How about the backward Euler method</p>
<p><span class="math display">\[
\left(u^{n+1}_N, v\right) = \left(u^{n}_N, v\right) + \Delta t \left(\frac{\partial^2 u^{n+1}_N}{\partial x^2}, v\right)
\]</span></p>
<p>The linear algebra problem is now</p>
<p><span class="math display">\[
\sum_{j=0}^N \left( (\psi_j, \psi_i) + \Delta t (\psi'_j, \psi'_i) \right)  \hat{u}^{n+1}_j = \sum_{j=0}^N(\psi_j, \psi_i) \hat{u}^{n}_j
\]</span></p>
<p>Insert the ansatz <span class="math inline">\(u^{n+1}_N = g u^n_N\)</span></p>
<p><span class="math display">\[
\sum_{j=0}^N g \left( (\psi_j, \psi_i) + \Delta t (\psi'_j, \psi'_i) \right)  \hat{u}^{0}_j = \sum_{j=0}^N(\psi_j, \psi_i) \hat{u}^{0}_j
\]</span></p>
</section>
<section id="backward-euler-on-matrix-form" class="slide level2 smaller">
<h2>Backward Euler on matrix form</h2>
<p><span class="math display">\[
\sum_{j=0}^N g \left( (\psi_j, \psi_i) + \Delta t (\psi'_j, \psi'_i) \right)  \hat{u}^{0}_j = \sum_{j=0}^N(\psi_j, \psi_i) \hat{u}^{0}_j
\]</span></p>
<p>becomes</p>
<p><span class="math display">\[
g (A + \Delta t S) \boldsymbol{\hat{u}}^0 = A \boldsymbol{\hat{u}}^0
\]</span></p>
<p>If we multiply from left to right by <span class="math inline">\(A^{-1}\)</span> we get</p>
<p><span class="math display">\[
g (I + \Delta t A^{-1}S) \boldsymbol{\hat{u}}^0 = \boldsymbol{\hat{u}}^0
\]</span></p>
<p>Here we can once again use <span class="math inline">\(H=A^{-1}S\)</span> and <span class="math inline">\(H \boldsymbol{\hat{u}}^0 = \lambda \boldsymbol{\hat{u}}^0\)</span> and thus we find</p>
<p><span class="math display">\[
g = \frac{1}{1+\Delta t \lambda}
\]</span></p>
<p>Since all time steps and eigenvalues are real numbers larger than 0, <span class="math inline">\(g\)</span> is always less than 1 and positive and the backward Euler method is as such <em>unconditionally</em> stable.</p>
</section>
<section id="the-wave-equation-as-a-variational-problem" class="slide level2 smaller">
<h2>The wave equation as a variational problem</h2>
<p><span class="math display">\[
\frac{\partial^2 u}{\partial t^2} = c^2 \frac{\partial^2 u}{\partial x^2}, \quad (x, t) \in (0, L) \times (0, T]
\]</span></p>
<p><span class="math display">\[
u(x, 0) = f(x) \quad \frac{\partial u}{\partial t}(x, 0) = 0
\]</span></p>
<p>We will consider both Dirichlet and Neumann boundary conditions in space and use finite differences in time such that</p>
<p><span class="math display">\[
\frac{u^{n+1}-2u^n+u^{n-1}}{\Delta t^2} = c^2 \frac{\partial^2 u^n}{\partial x^2}
\]</span></p>
<div class="fragment">
<p>A numerical residual <span class="math inline">\(\mathcal{R}_N = \mathcal{R}(u^{n+1}_N; u^n_N, u^{n-1}_N)\)</span> can now be defined as</p>
<p><span class="math display">\[
\mathcal{R}_N={u_N^{n+1}-2u_N^n+u_N^{n-1}} - \alpha^2 (u_N^n)''
\]</span></p>
<p>with <span class="math inline">\(\alpha = c \Delta t\)</span> and <span class="math inline">\(u'=\frac{\partial u}{\partial x}\)</span>.</p>
</div>
</section>
<section id="the-galerkin-methods-for-the-wave-equation" class="slide level2 smaller">
<h2>The Galerkin methods for the wave equation</h2>
<p>Initialize <span class="math inline">\(u_N^0\)</span> and <span class="math inline">\(u_N^1\)</span>. The Galerkin method is to find <span class="math inline">\(u^{n+1}_N \in V_N\)</span> such that</p>
<p><span class="math display">\[
\left({u_N^{n+1}-2u_N^n+u_N^{n-1}} - \alpha^2 (u_N^n)'', v \right) = 0, \quad \forall \, v \in V_N
\]</span></p>
<p>for <span class="math inline">\(n = 1, \ldots, N_t-1\)</span>. We can also integrate the last term by parts</p>
<p><span class="math display">\[
({u_N^{n+1}-2u_N^n+u_N^{n-1}}, v) + \alpha^2 \left( \left((u_N^n)', v' \right) - \left[(u^n_N)' v\right]_{x=0}^{x=L} \right)  = 0, \quad \forall \, v \in V_N
\]</span></p>
<div class="fragment">
<p>Insert for <span class="math inline">\(u^{n-1}_N, u^{n}_N, u^{n+1}_N \in V_N\)</span> and use <span class="math inline">\(v = \psi_i\)</span> to get the linear algebra problem</p>
<p><span class="math display">\[
\sum_{j=0}^N \left(\psi_j, \psi_i \right)  \left(\hat{u}^{n+1}_j - 2\hat{u}^{n}_j + \hat{u}^{n-1}_j\right)
+ \alpha^2 \left(\sum_{j=0}^N \left(\psi'_j, \psi'_i \right) \hat{u}^n_j - \left[(u^n_N)' \psi_i\right]_{x=0}^{x=L}  \right) = 0
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>All time dependency is in the expansion coefficients <span class="math inline">\(\hat{u}^n_{j}, \hat{u}^{n}_{j}, \hat{u}^{n-1}_{j}\)</span>.</p>
</div>
</div>
</div>
</div>
</section>
<section id="matrix-form" class="slide level2 smaller">
<h2>Matrix form</h2>
<p>Rearrange such that the unknown <span class="math inline">\(\hat{u}_j^{n+1}\)</span> is on the left hand side and the rest of the known terms are on the right hand side</p>
<p><span class="math display">\[
\sum_{j=0}^N \left(\psi_j, \psi_i \right) \hat{u}^{n+1}_j =  \sum_{j=0}^N \left(\psi_j, \psi_i \right) (2\hat{u}^{n}_j - \hat{u}^{n-1}_j) - \alpha^2 \left( \sum_{j=0}^N \left(\psi'_j, \psi'_i \right) \hat{u}^n_j - \left[(u^n_N)' \psi_i\right]_{x=0}^{x=L} \right)
\]</span></p>
<p>With matrix notation, <span class="math inline">\(a_{ij} = (\psi_j, \psi_i)\)</span> and <span class="math inline">\(s_{ij} = (\psi'_j, \psi'_i)\)</span>, we get</p>
<p><span class="math display">\[
A \boldsymbol{\hat{u}}^{n+1} = A (2 \boldsymbol{\hat{u}}^n - \boldsymbol{\hat{u}}^{n-1}) - \alpha^2 \left( S \boldsymbol{\hat{u}}^n  - \boldsymbol{b}^n \right)
\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{b}^n = ((u^n_N)'(L) \psi_i(L) - (u^n_N)'(0) \psi_i(0))_{i=0}^N\)</span>.</p>
<div class="fragment">
<p>We can write this as</p>
<p><span class="math display">\[
A \boldsymbol{\hat{u}}^{n+1} = \boldsymbol{f}^n
\]</span></p>
<p>where the vector <span class="math inline">\(\boldsymbol{f}^n = A (2 \boldsymbol{\hat{u}}^n - \boldsymbol{\hat{u}}^{n-1}) - \alpha^2 \left( S \boldsymbol{\hat{u}}^n  - \boldsymbol{b}^n\right)\)</span>.</p>
</div>
</section>
<section id="dirichlet-boundary-conditions-u0-t-a-and-ul-t-b" class="slide level2 smaller">
<h2>Dirichlet boundary conditions <span class="math inline">\(u(0, t) = a\)</span> and <span class="math inline">\(u(L, t) = b\)</span></h2>
<p><span class="math display">\[
{b}_i^n = (u^n_N)'(L) \psi_i(L) - (u^n_N)'(0) \psi_i(0), \quad i=0,1, \ldots, N
\]</span></p>
<h3 id="global-variational-methods">Global variational methods</h3>
<p><span class="math display">\[
\psi_i(0) = \psi_i(L) = 0, \quad i=0, 1, \ldots, N
\]</span></p>
<p><span class="math display">\[
\Rightarrow \boldsymbol{b}^n = 0, \quad \forall \, n=1, 2, \ldots, N_t-1
\]</span></p>
<div class="fragment">
<p>Use a boundary function (with reference coordinate <span class="math inline">\(X\in [-1, 1]\)</span>) <span class="math display">\[
B(x)=\tilde{B}(X) = \frac{b}{2}(1+X) + \frac{a}{2}(1-X)
\]</span></p>
<p>and solve for <span class="math inline">\(\tilde{u}^n_N \in V_N = \text{span}\{\psi_j\}_{j=0}^N\)</span>. Final solution is then</p>
<p><span class="math display">\[
u^n_N = \tilde{u}^n_N + B(x)
\]</span></p>
</div>
</section>
<section id="dirichlet-with-the-finite-element-method" class="slide level2 smaller">
<h2>Dirichlet with the finite element method</h2>
<p>Makes use of Lagrange polynomials and <span class="math inline">\(\psi_i(0)= 1\)</span> for <span class="math inline">\(i=0\)</span> and zero otherwise. Similarly, <span class="math inline">\(\psi_i(L)=1\)</span> for <span class="math inline">\(i=N\)</span> and zero otherwise. Hence it is only <span class="math inline">\(b^n_0\)</span> and <span class="math inline">\(b^n_N\)</span> that potentially are different from zero. However,</p>
<p><span class="math display">\[
u(0, t)=a = \hat{u}^{n+1}_0 \quad \text{and} \quad u(L, t) = b = \hat{u}^{n+1}_N
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Since <span class="math inline">\(\hat{u}_0\)</span> and <span class="math inline">\(\hat{u}_N\)</span> are known we do not solve the linear PDE for <span class="math inline">\(i=0\)</span> or <span class="math inline">\(i=N\)</span>. Simply ident the coefficient matrix <span class="math inline">\(A\)</span> and set <span class="math inline">\(f^n_0=a\)</span> and <span class="math inline">\(f^n_N=b\)</span>.</p>
</div>
</div>
</div>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
a_{10} &amp; a_{11}&amp; a_{12} &amp; \cdots &amp; a_{1N} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{N-1, 0} &amp; a_{N-1, 1}&amp; a_{N-1, 2}&amp; \cdots &amp; a_{N-1,N} \\
0 &amp; \cdots &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\hat{u}^{n+1}_0 \\
\hat{u}^{n+1}_1 \\
\vdots \\
\hat{u}^{n+1}_{N-1} \\
\hat{u}^{n+1}_N
\end{bmatrix}
=
\begin{bmatrix}
a \\
f^{n}_1 \\
\vdots \\
f^{n}_{N-1} \\
b
\end{bmatrix}
\]</span></p>
</section>
<section id="neumann-boundary-conditions-u0-t-g_0-quad-textand-quad-ul-t-g_l" class="slide level2 smaller">
<h2>Neumann boundary conditions <span class="math inline">\(u'(0, t) = g_0 \quad \text{and} \quad u'(L, t) = g_L\)</span></h2>
<p><span class="math display">\[
{b}_i^n = (u^n_N)'(L) \psi_i(L) - (u^n_N)'(0) \psi_i(0), \quad i=0,1, \ldots, N
\]</span></p>
<h3 id="apply-neumann-strongly-through-basis">Apply Neumann strongly through basis</h3>
<p>Use basis functions satisfying <span class="math display">\[
\psi'_j(0) = \psi'_j(L) = 0, \quad j=0, 1, \ldots, N
\]</span></p>
<div class="fragment">
<p>Add a boundary function <span class="math inline">\(B(x)\)</span> that satisfied <span class="math inline">\(B'(0)=g_0\)</span> and <span class="math inline">\(B'(L)=g_L\)</span></p>
<p><span class="math display">\[
B(x) = \tilde{B}(X) = \frac{L}{8}\left({g_L}(1+X)^2 - {g_0}(1-X)^2\right)
\]</span></p>
<p>The <span class="math inline">\(L\)</span> is there since <span class="math inline">\(X=-1+\frac{2x}{L}\)</span> and <span class="math inline">\(\frac{\partial X}{\partial x}=\frac{2}{L}\)</span> and thus</p>
<p><span class="math display">\[
\frac{\partial B}{\partial x} = \frac{\partial \tilde{B}}{\partial X}\frac{\partial X}{\partial x} = \frac{2}{L}\frac{\partial \tilde{B}}{\partial X}
\]</span></p>
</div>
</section>
<section id="neumann-boundary-conditions-weakly" class="slide level2 smaller">
<h2>Neumann boundary conditions weakly</h2>
<h3 id="apply-boundary-condition-weakly-through-variational-form">Apply boundary condition weakly through variational form</h3>
<p><span class="math display">\[
{b}_i^n = (u^n_N)'(L) \psi_i(L) - (u^n_N)'(0) \psi_i(0), \quad i=0,1,\ldots, N
\]</span></p>
<p>Insert for <span class="math inline">\((u^n_N)'(0) = g_0\)</span> and <span class="math inline">\((u^n_N)'(L)=g_L\)</span></p>
<p><span class="math display">\[
{b}_i^n = g_L \psi_i(L) - g_0 \psi_i(0)
\]</span></p>
<p>Use any basis function, except those where all <span class="math inline">\(\psi_i(0)=0\)</span> and <span class="math inline">\(\psi_i(L)=0\)</span>, for all <span class="math inline">\(i=0,1,\ldots, N\)</span>.</p>
<div class="fragment">
<ul>
<li><p>This works for the finite element method, where <span class="math inline">\(\psi_0(0)=1\)</span> and <span class="math inline">\(\psi_N(L)=1\)</span>. Nothing else is required</p></li>
<li><p>Also works for the global Galerkin method, e.g., Legendre polynomials <span class="math inline">\(\psi_i(x)=P_i(X)\)</span>.</p></li>
<li><p>Does not work for Chebyshev because the method relies on integration by parts, which does not work with the Chebyshev weights <span class="math inline">\(\omega(x)=1/\sqrt{1-X^2}\)</span>.</p></li>
</ul>
</div>
</section>
<section id="stability-of-the-wave-equation-in-variational-form" class="slide level2 smaller">
<h2>Stability of the wave equation in variational form</h2>
<p>We have derived the linear algebra problem</p>
<p><span class="math display">\[
A (\boldsymbol{\hat{u}}^{n+1} -2 \boldsymbol{\hat{u}}^n + \boldsymbol{\hat{u}}^{n-1}) = - \alpha^2 \left( S \boldsymbol{\hat{u}}^n  - \boldsymbol{b}^n \right)
\]</span></p>
<p>The ansatz <span class="math inline">\(u_N^{n+1}=gu^{n}_N=g^{n+1}u_N^0\)</span> also implies that</p>
<p><span class="math display">\[
\boldsymbol{\hat{u}}^{n+1} = g \boldsymbol{\hat{u}}^n  = g^{n+1} \boldsymbol{\hat{u}}^0 \tag{1}
\]</span></p>
<p>since</p>
<p><span class="math display">\[
u^{n+1}_N = g u^{n}_N \Rightarrow \sum_{j=0}^N \hat{u}^{n+1}_j \psi_j = g \sum_{j=0}^N \hat{u}^{n}_j \psi_j = \sum_{j=0}^N (g\hat{u}^{n}_j) \psi_j
\]</span></p>
<p>Hence <span class="math inline">\(\hat{u}^{n+1}_j = g\hat{u}^n_j\)</span>. Recursively, we get (1).</p>
</section>
<section id="find-amplification-factor" class="slide level2 smaller">
<h2>Find amplification factor</h2>
<p><span class="math display">\[
A (\boldsymbol{\hat{u}}^{n+1} -2 \boldsymbol{\hat{u}}^n + \boldsymbol{\hat{u}}^{n-1}) = - \alpha^2 \left( S \boldsymbol{\hat{u}}^n  - \boldsymbol{b}^n \right)
\]</span></p>
<p>Insert for <span class="math inline">\(\boldsymbol{\hat{u}}^{n} = g^{n} \boldsymbol{\hat{u}}^0\)</span> and assume that <span class="math inline">\(\boldsymbol{b}^n=\boldsymbol{0}\)</span></p>
<p><span class="math display">\[
(g^{n+1}-2g^n+g^{n-1}) A \boldsymbol{\hat{u}}^0 = -\alpha^2 g^n S \boldsymbol{\hat{u}}^0
\]</span></p>
<p>Divide by <span class="math inline">\(g^n\)</span> and multiply by <span class="math inline">\(A^{-1}\)</span> from the left</p>
<p><span class="math display">\[
(g - 2 + g^{-1}) I \boldsymbol{\hat{u}}^0 = -\alpha^2 A^{-1}S \boldsymbol{\hat{u}} ^{0}
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The identity matrix <span class="math inline">\(I\)</span> on the left is optional and can be removed.</p>
</div>
</div>
</div>
</section>
<section id="find-amplification-factor-2" class="slide level2 smaller">
<h2>Find amplification factor 2</h2>
<p><span class="math display">\[
(g - 2 + g^{-1}) I \boldsymbol{\hat{u}}^0 = -\alpha^2 A^{-1}S \boldsymbol{\hat{u}} ^{0}
\]</span></p>
<p>Use <span class="math inline">\(H = A^{-1} S\)</span> and the eigenvalues <span class="math inline">\(H \boldsymbol{\hat{u}}^0 = \lambda I \boldsymbol{\hat{u}}^0\)</span> to get</p>
<p><span class="math display">\[
(g - 2 + g^{-1}) I \boldsymbol{\hat{u}}^0 = -\alpha^2 \lambda I \boldsymbol{\hat{u}} ^{0}
\]</span></p>
<p>and after eliminating the equal terms on both sides <span class="math display">\[
g + g^{-1} = \beta \tag{1}
\]</span></p>
<p>where <span class="math inline">\(\beta = -\alpha^2 \lambda +2\)</span>.</p>
<h3 id="for-stability-we-need-g-le-1.">For stability we need <span class="math inline">\(|g| \le 1\)</span>.</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>If <span class="math inline">\(g&lt;1\)</span> is a root of (1), then <span class="math inline">\(g^{-1}&gt;1\)</span> is also a root, which is unstable. All roots must be <span class="math inline">\(\le 1\)</span>. Hence <span class="math inline">\(|g|=1\)</span> is the only possible solution.</p>
</div>
</div>
</div>
</section>
<section id="find-the-longest-stable-time-step" class="slide level2 smaller">
<h2>Find the longest stable time step</h2>
<p><span class="math display">\[
g + g^{-1} = \beta
\]</span></p>
<p>Solve quadratic equation for <span class="math inline">\(g\)</span></p>
<p><span class="math display">\[
g = \frac{\beta \pm \sqrt{\beta^2-4}}{2}
\]</span></p>
<div class="fragment">
<p>Assume <span class="math inline">\(-2 \le \beta \le 2\)</span> such that <span class="math inline">\(\beta^2-4 \le 0\)</span> and <span class="math inline">\(\sqrt{\beta^2-4} = a \hat{\imath}\)</span>, with <span class="math inline">\(a=\sqrt{4-\beta^2}\)</span> real</p>
<p><span class="math display">\[
2|g| = \left| \beta \pm \sqrt{\beta^2-4}\right| = \left|\beta \pm a\hat{\imath} \right| = \sqrt{\beta^2+a^2} = \sqrt{\beta^2+4-\beta^2}=2
\]</span></p>
<p>For <span class="math inline">\(-2 \le \beta \le 2\)</span> we get that <span class="math inline">\(|g|=1\)</span> and the numerical solution is stable!</p>
</div>
<div class="fragment">
<p>Using <span class="math inline">\(\beta=-\alpha^2 \lambda +2 = -(c \Delta t)^2 \lambda +2 = -2\)</span> the longest possible time step is</p>
<p><span class="math display">\[
\Delta t \le \frac{1}{c}\sqrt{\frac{4}{\max(\lambda)}}
\]</span></p>
</div>
</section>
<section id="implementation---overload-diffusion-solver" class="slide level2 smaller">
<h2>Implementation - Overload diffusion solver</h2>
<p>We are using the same function space and thus the same matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(S\)</span> as the diffusion equation. We only need to reimplement the time stepper in <code>__call__</code>.</p>
<div id="24c14bb1" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="kw">class</span> Wave(FE_Diffusion):</span>
<span id="cb6-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, N, L0<span class="op">=</span><span class="dv">1</span>, c0<span class="op">=</span><span class="dv">1</span>, u0<span class="op">=</span>sp.sin(sp.pi<span class="op">*</span>x<span class="op">/</span>L)):</span>
<span id="cb6-3"><a></a>        u0 <span class="op">=</span> u0.subs({c: c0})</span>
<span id="cb6-4"><a></a>        FE_Diffusion.<span class="fu">__init__</span>(<span class="va">self</span>, N, L0<span class="op">=</span>L0, u0<span class="op">=</span>u0)</span>
<span id="cb6-5"><a></a>        <span class="va">self</span>.c <span class="op">=</span> c0</span>
<span id="cb6-6"><a></a>        <span class="va">self</span>.uh_nm1 <span class="op">=</span> np.zeros_like(<span class="va">self</span>.uh_n)</span>
<span id="cb6-7"><a></a></span>
<span id="cb6-8"><a></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, Nt, dt<span class="op">=</span><span class="fl">0.1</span>, save_step<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb6-9"><a></a>        <span class="va">self</span>.uh_nm1[:] <span class="op">=</span> project(<span class="va">self</span>.u0.subs(t, <span class="dv">0</span>), <span class="va">self</span>.V)</span>
<span id="cb6-10"><a></a>        xj <span class="op">=</span> <span class="va">self</span>.V.mesh()</span>
<span id="cb6-11"><a></a>        plotdata <span class="op">=</span> {<span class="dv">0</span>: <span class="va">self</span>.uh_nm1(xj)}</span>
<span id="cb6-12"><a></a>        <span class="va">self</span>.uh_n[:] <span class="op">=</span> project(<span class="va">self</span>.u0.subs(t, dt), <span class="va">self</span>.V)</span>
<span id="cb6-13"><a></a>        <span class="cf">if</span> save_step <span class="op">==</span> <span class="dv">1</span>: plotdata[<span class="dv">1</span>] <span class="op">=</span> <span class="va">self</span>.uh_n(xj)</span>
<span id="cb6-14"><a></a></span>
<span id="cb6-15"><a></a>        f <span class="op">=</span> np.zeros(<span class="va">self</span>.N<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb6-16"><a></a>        alfa <span class="op">=</span> <span class="va">self</span>.c<span class="op">*</span>dt</span>
<span id="cb6-17"><a></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, Nt<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb6-18"><a></a>            f[:<span class="op">-</span><span class="dv">2</span>] <span class="op">=</span> <span class="va">self</span>.A <span class="op">@</span> (<span class="dv">2</span><span class="op">*</span><span class="va">self</span>.uh_n[:<span class="op">-</span><span class="dv">2</span>]<span class="op">-</span><span class="va">self</span>.uh_nm1[:<span class="op">-</span><span class="dv">2</span>]) <span class="op">\</span></span>
<span id="cb6-19"><a></a>              <span class="op">-</span> alfa<span class="op">**</span><span class="dv">2</span><span class="op">*</span>(<span class="va">self</span>.S <span class="op">@</span> <span class="va">self</span>.uh_n[:<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb6-20"><a></a>            <span class="va">self</span>.uh_np1[:] <span class="op">=</span> <span class="va">self</span>.sol(f)</span>
<span id="cb6-21"><a></a>            <span class="va">self</span>.uh_nm1[:] <span class="op">=</span> <span class="va">self</span>.uh_n</span>
<span id="cb6-22"><a></a>            <span class="va">self</span>.uh_n[:] <span class="op">=</span> <span class="va">self</span>.uh_np1</span>
<span id="cb6-23"><a></a>            <span class="cf">if</span> n <span class="op">%</span> save_step <span class="op">==</span> <span class="dv">0</span>: <span class="co"># save every save_step timestep</span></span>
<span id="cb6-24"><a></a>                plotdata[n] <span class="op">=</span> <span class="va">self</span>.uh_np1(xj)</span>
<span id="cb6-25"><a></a>        <span class="cf">return</span> plotdata </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-stability" class="slide level2 smaller">
<h2>Check stability</h2>
<div id="c1330ca2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a>sol <span class="op">=</span> Wave(<span class="dv">40</span>, L0<span class="op">=</span><span class="dv">2</span>, c0<span class="op">=</span><span class="dv">1</span>, u0<span class="op">=</span>sp.exp(<span class="op">-</span><span class="dv">40</span><span class="op">*</span>(x<span class="op">-</span>L<span class="op">/</span><span class="dv">2</span><span class="op">+</span>c<span class="op">*</span>t)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb7-2"><a></a>dt <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>sol.c<span class="op">*</span>np.sqrt(<span class="dv">4</span><span class="op">/</span><span class="bu">max</span>(sol.get_eigenvalues()))</span>
<span id="cb7-3"><a></a>data <span class="op">=</span> sol(<span class="dv">400</span>, dt<span class="op">=</span>dt, save_step<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb7-4"><a></a>plot_with_offset(data, sol.V.mesh(), figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="fl">2.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="timevar_files/figure-revealjs/cell-7-output-1.png" class="quarto-figure quarto-figure-center" width="641" height="226"></p>
</figure>
</div>
</div>
</div>
<div id="f7b15e52" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a>data <span class="op">=</span> sol(<span class="dv">400</span>, dt<span class="op">=</span>dt<span class="op">*</span><span class="fl">1.01</span>, save_step<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb8-2"><a></a>plot_with_offset(data, sol.V.mesh(), figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="fl">2.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="timevar_files/figure-revealjs/cell-8-output-1.png" class="quarto-figure quarto-figure-center" width="632" height="240"></p>
</figure>
</div>
</div>
</div>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>